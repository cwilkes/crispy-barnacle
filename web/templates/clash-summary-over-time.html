<!doctype html> 
<html> 
<head>  <title>Clashes over time</title>  {% include 'head.html' %} </head>
 
<body>  <p id="description">  High-level, day-over-day clashes over time. </p>


  <select id="grouping"> </select>  
<div id="plot"> </div>
   
<script type="text/javascript">
  var svg = dimple.newSvg("#plot", 800, 600);
  function replot(data) {
    svg.selectAll('*').remove();
    var grouping = $('#grouping').val();
    console.log(grouping);
    var myChart = new dimple.chart(svg, data);
    var x = myChart.addTimeAxis("x", "date", "%Y-%m-%d", "%Y-%m-%d");
    var y = myChart.addMeasureAxis("y", "n_clashes");
    var series = myChart.addSeries('group', dimple.plot.bubble, [x, y]);
    series.data = data[grouping];
    myChart.addLegend(60, 10, 500, 20, "right");
    myChart.draw();
  }
  $.getJSON('{{ data_url }}', function (response) {
    var data = response;
    $.each(data, function (key, value) {
      $('#grouping').append($('<option>', {key: key}).text(key));
    });
    replot(data);
    var mySelect = document.getElementById("grouping");
    mySelect.addEventListener('change', function () {
      replot(data)
    });
  });
  </script>
  
</body>
   
</html> 
